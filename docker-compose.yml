version: '3.8'

services:
  memory-api:
    build: .
    container_name: memory-api
    environment:
      # Database path inside container
      - MEMORY_DB_PATH=/data/household_memory.sqlite3
      # Logging level (DEBUG, INFO, WARNING, ERROR)
      - MEMORY_LOG_LEVEL=INFO
      # OpenAI API key (optional, for LLM-powered features)
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
    volumes:
      # Mount data directory for SQLite persistence
      - ./data:/data
    ports:
      # LAN-only binding via 127.0.0.1 (use with reverse proxy)
      # Change to "8088:8088" if you want to expose on all interfaces
      - "127.0.0.1:8088:8088"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-fsS", "http://localhost:8088/health"]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 10s
    networks:
      - memory-network

networks:
  memory-network:
    driver: bridge
